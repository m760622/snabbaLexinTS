import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{b as a,c as g,a as p}from"./games-utils-Di73MU7e.js";import{T as d}from"./tts-BPLy4HEw.js";import"./config-CfHoVMbv.js";import"./toast-manager-CZ3snF2j.js";console.log("pronunciationGame.ts LOADED");let s=null,f=0,l=!1,r=null;function m(){if("webkitSpeechRecognition"in window)r=new webkitSpeechRecognition;else if("SpeechRecognition"in window)r=new SpeechRecognition;else return;r.lang="sv-SE",r.continuous=!1,r.interimResults=!1,r.onresult=w,r.onerror=k,r.onend=()=>{l=!1,y()}}function B(){const t=document.getElementById("pronunciationWord"),o=document.getElementById("pronunciationTranslation"),i=document.getElementById("pronunciationFeedback"),n=document.getElementById("nextPronunciationBtn");if(!t||!o||!i)return;i.innerHTML="",i.className="pronunciation-feedback",n&&(n.style.display="none");let e=null,u=0;for(;!e&&u<200;){const c=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];c&&c[a]&&c[g]&&c[a].length>=3&&c[a].length<=12&&!c[a].includes(" ")&&(e=c),u++}if(!e){t.textContent="Fel",o.textContent="Kunde inte hitta ett ord";return}s=e[a].toLowerCase(),t.textContent=e[a],o.textContent=e[g],r||m(),typeof d<"u"&&d&&setTimeout(()=>d.speak(e[a],"sv"),500)}function h(){if(!r&&(m(),!r)){E("Tyvärr stöds inte tal i denna webbläsare","error");return}if(l)r.stop(),l=!1;else try{r.start(),l=!0}catch(t){console.error("Speech recognition error:",t)}y()}function y(){const t=document.getElementById("micBtn"),o=document.getElementById("micStatus");!t||!o||(l?(t.classList.add("listening"),o.textContent="Lyssnar... / أستمع..."):(t.classList.remove("listening"),o.textContent="Tryck för att tala / اضغط للتحدث"))}function w(t){const o=document.getElementById("pronunciationFeedback"),i=document.getElementById("nextPronunciationBtn"),n=document.getElementById("pronunciationScore");if(!o||!s)return;let e="";for(let c=t.resultIndex;c<t.results.length;c++)e+=t.results[c][0].transcript;e=e.toLowerCase().trim(),console.log("Heard:",e,"Target:",s),e.includes(s)||s.includes(e)||S(e,s)<=2?(o.innerHTML=`✅ Bra uttal! / نطق ممتاز!<br><span style="opacity:0.7">Du sa: "${e}"</span>`,o.className="pronunciation-feedback success",f++,n&&(n.textContent=String(f)),typeof p=="function"&&p("pronunciation",f)):(o.innerHTML=`⚠️ Försök igen!<br><span style="opacity:0.7">Du sa: "${e}"</span>`,o.className="pronunciation-feedback warning"),i&&(i.style.display="block")}function k(t){console.error("Speech error:",t.error),E(`Fel: ${t.error}`,"error")}function E(t,o){const i=document.getElementById("pronunciationFeedback");i&&(i.textContent=t,i.className=`pronunciation-feedback ${o}`)}function S(t,o){if(t.length===0)return o.length;if(o.length===0)return t.length;const i=[];for(let n=0;n<=o.length;n++)i[n]=[n];for(let n=0;n<=t.length;n++)i[0][n]=n;for(let n=1;n<=o.length;n++)for(let e=1;e<=t.length;e++)o.charAt(n-1)===t.charAt(e-1)?i[n][e]=i[n-1][e-1]:i[n][e]=Math.min(i[n-1][e-1]+1,i[n][e-1]+1,i[n-1][e]+1);return i[o.length][t.length]}document.addEventListener("DOMContentLoaded",()=>{m();const t=document.getElementById("micBtn");t&&(t.onclick=h)});window.startPronunciationGame=B;window.toggleMic=h;
