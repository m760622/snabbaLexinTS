import"./modulepreload-polyfill-B5Qt9EMX.js";import"./loader-Dms16IQi.js";import{A as m}from"./config-CfHoVMbv.js";import"./pwa-Bxh5GLjF.js";import"./db-bEbbjtoI.js";import"./utils-DkwAXeNx.js";import"./toast-manager-CZ3snF2j.js";const p=m.COLUMNS.SWEDISH,C=m.COLUMNS.ARABIC,T=m.COLUMNS.TYPE,x=m.COLUMNS.EXAMPLE_SWE,B=m.COLUMNS.EXAMPLE_ARB;let S=[],s=[],y=0,f=0,u=0,c=null,l=0,d=!1,h="all",L=[];const I=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",I);I==="dark"&&document.body.classList.add("dark-mode");function O(){return new Promise(t=>{const e=()=>{typeof dictionaryData<"u"&&Array.isArray(dictionaryData)&&dictionaryData.length>0?t(dictionaryData):setTimeout(e,100)};e()})}async function w(){try{L=await O(),E()}catch(t){console.error("Error initializing memory game:",t)}}function E(){k(),P(),W()}function k(){S=[],s=[],y=0,f=0,u=0,d=!1,l=0,c&&(clearInterval(c),c=null),g()}function G(){let t=L.filter(e=>e[p]&&e[C]);return h!=="all"&&(t=t.filter(e=>(e[T]||"").toLowerCase().includes(h))),b(t).slice(0,6)}function b(t){const e=[...t];for(let n=e.length-1;n>0;n--){const a=Math.floor(Math.random()*(n+1));[e[n],e[a]]=[e[a],e[n]]}return e}function P(){const t=document.getElementById("memoryGrid");if(!t)return;t.innerHTML="",t.style.gridTemplateColumns="repeat(4, 1fr)";const e=G(),n=[];e.forEach((o,r)=>{n.push({text:o[p],pairId:r,isArabic:!1,wordData:o}),n.push({text:o[C],pairId:r,isArabic:!0,wordData:o})}),b(n).forEach((o,r)=>{const i=document.createElement("div");i.className="card",i.dataset.pairId=String(o.pairId),i.dataset.index=String(r),i.style.animationDelay=`${r*.05}s`,i.style.animation="cardEntrance 0.5s ease-out forwards";const A=o.isArabic&&o.text.length<7;i.innerHTML=`
            <div class="face front"></div>
            <div class="face back ${o.isArabic?"arabic":""} ${A?"is-short":""}">
                <div class="card-content">${o.text}</div>
            </div>
        `,i.addEventListener("click",()=>N(i,o)),t.appendChild(i),S.push(i)})}function N(t,e){if(!(d||t.classList.contains("flipped")||t.classList.contains("matched"))&&(t.classList.add("flipped"),s.push(t),v("flip"),s.length===2)){d=!0,f++,g();const[n,a]=s,o=n.dataset.pairId,r=a.dataset.pairId;o===r?_(e.wordData):U()}}function _(t){setTimeout(()=>{s.forEach(e=>{e.classList.add("matched")}),y++,u+=100+Math.max(0,50-f*2),$(t),v("match"),s=[],d=!1,g(),y===6&&D()},500)}function U(){setTimeout(()=>{s.forEach(t=>{t.classList.add("shake"),setTimeout(()=>{t.classList.remove("shake","flipped")},500)}),v("wrong"),s=[],d=!1},1e3)}function $(t){const e=document.getElementById("feedbackToast"),n=document.getElementById("ftWord"),a=document.getElementById("ftSentenceSwe"),o=document.getElementById("ftSentenceArb");e&&n&&a&&o&&(n.textContent=t[p],a.textContent=t[x]||"",o.textContent=t[B]||"",e.classList.add("visible"),setTimeout(()=>{e.classList.remove("visible")},2500))}function D(){c&&(clearInterval(c),c=null);const t=document.getElementById("gameOverModal"),e=document.getElementById("finalScore"),n=document.getElementById("finalMoves"),a=document.getElementById("finalTime");t&&e&&n&&a&&(e.textContent=String(u),n.textContent=String(f),a.textContent=M(l),t.classList.add("visible"),q()),R()}function W(){c=setInterval(()=>{l++,g()},1e3)}function M(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}function g(){const t=document.getElementById("scoreValue"),e=document.getElementById("movesValue"),n=document.getElementById("timerValue");t&&(t.textContent=String(u)),e&&(e.textContent=String(f)),n&&(n.textContent=M(l))}function v(t){try{const e=new(window.AudioContext||window.webkitAudioContext),n=e.createOscillator(),a=e.createGain();switch(n.connect(a),a.connect(e.destination),t){case"flip":n.frequency.value=300,a.gain.value=.1;break;case"match":n.frequency.value=600,a.gain.value=.15;break;case"wrong":n.frequency.value=150,a.gain.value=.12;break}n.start(),n.stop(e.currentTime+.1)}catch{}}function q(){typeof window.confetti=="function"&&window.confetti({particleCount:150,spread:70,origin:{y:.6}})}function R(){try{const t=JSON.parse(localStorage.getItem("memoryGameStats")||"{}");t.gamesPlayed=(t.gamesPlayed||0)+1,t.bestScore=Math.max(t.bestScore||0,u),t.bestTime=t.bestTime?Math.min(t.bestTime,l):l,localStorage.setItem("memoryGameStats",JSON.stringify(t))}catch(t){console.error("Error saving stats:",t)}}function X(t,e){h=t,document.querySelectorAll(".pill").forEach(n=>n.classList.remove("active")),e.classList.add("active"),E()}function F(){const t=document.getElementById("gameOverModal");t&&t.classList.remove("visible"),E()}window.selectCategory=X;window.restartGame=F;document.addEventListener("DOMContentLoaded",w);window.addEventListener("dictionaryLoaded",w);
