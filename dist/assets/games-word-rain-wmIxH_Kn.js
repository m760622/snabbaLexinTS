import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import"./games-utils-ByroIWVH.js";import"./config-CfHoVMbv.js";console.log("wordRainGame.ts LOADED (Premium Upgrade)");let o,n,l=[],r=[],s=0,d=3,m=!1,g=null,y=0,h=2e3;const x=["#fbbf24","#f59e0b","#ffffff","#60a5fa"];function p(t=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){t<10?(console.warn(`Data not ready for Rain Game. Retrying (${t+1}/10)...`),typeof showToast=="function"&&showToast("Laddar speldata... / جاري تحميل البيانات...","info"),setTimeout(()=>p(t+1),500)):(console.error("Critical: Data failed to load for Rain Game."),typeof showToast=="function"&&showToast("Kunde inte ladda data. Uppdatera sidan. / تعذر تحميل البيانات.","error"));return}const a=document.getElementById("rainCanvas");if(!a)return;o=a,n=o.getContext("2d"),o.width=o.offsetWidth||600,o.height=o.offsetHeight||400,l=[],r=[],s=0,d=3,m=!1;const e=document.getElementById("rainScore"),i=document.getElementById("rainLives"),c=document.getElementById("rainGameOver"),f=document.getElementById("rainInput"),u=document.getElementById("startRainBtn");e&&(e.textContent="0"),i&&(i.textContent="3"),c&&c.classList.add("hidden"),f&&(f.disabled=!0,f.value=""),u&&(u.style.display="block"),n.clearRect(0,0,o.width,o.height),n.font="24px Inter, sans-serif",n.fillStyle="rgba(255,255,255,0.8)",n.textAlign="center",n.fillText("Redo att spela? / مستعد للعب؟",o.width/2,o.height/2),u&&(u.onclick=B);const E=document.getElementById("restartRainBtn");E&&(E.onclick=()=>p()),f&&(f.onkeydown=I=>{I.key==="Enter"&&L()})}function B(){m=!0,l=[],r=[],s=0,d=3,y=Date.now();const t=document.getElementById("rainScore"),a=document.getElementById("rainLives"),e=document.getElementById("startRainBtn"),i=document.getElementById("rainInput");t&&(t.textContent="0"),a&&(a.textContent="3"),e&&(e.style.display="none"),i&&(i.disabled=!1,i.focus()),v()}function v(){if(!m)return;const t=Date.now();t-y>h&&(S(),y=t,h=Math.max(800,h-20)),l.forEach(e=>{e.y+=e.speed,e.x+=Math.sin(e.y*.05)*.5});for(let e=r.length-1;e>=0;e--){const i=r[e];i.x+=i.vx,i.y+=i.vy,i.life-=.02,i.vy+=.05,i.life<=0&&r.splice(e,1)}const a=document.getElementById("rainLives");l=l.filter(e=>e.y>o.height+20?(d--,a&&(a.textContent=String(d)),o.style.transform=`translateX(${Math.random()*10-5}px)`,setTimeout(()=>o.style.transform="none",100),d<=0&&R(),!1):!0),b(),m&&(g=requestAnimationFrame(v))}function S(){let t=null,a=0;for(;!t&&a<100;){const e=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];e&&e[COL_SWE]&&e[COL_ARB]&&e[COL_SWE].length<=10&&(t={swedish:e[COL_SWE],arabic:e[COL_ARB],x:Math.random()*(o.width-100)+50,y:-40,speed:1+Math.random()*1.5,color:`hsl(${Math.random()*60+200}, 80%, 70%)`}),a++}t&&l.push(t)}function b(){n.clearRect(0,0,o.width,o.height),r.forEach(t=>{n.globalAlpha=t.life,n.fillStyle=t.color,n.beginPath(),n.arc(t.x,t.y,t.size,0,Math.PI*2),n.fill()}),n.globalAlpha=1,l.forEach(t=>{const a=n.measureText(t.arabic).width+30;n.shadowColor=t.color,n.shadowBlur=15,n.fillStyle="rgba(255, 255, 255, 0.1)",n.strokeStyle="rgba(255, 255, 255, 0.3)",n.lineWidth=1,n.beginPath(),n.roundRect(t.x-a/2,t.y-18,a,40,20),n.fill(),n.stroke(),n.shadowBlur=0,n.font='bold 20px "Noto Sans Arabic", sans-serif',n.fillStyle="#fbbf24",n.textAlign="center",n.fillText(t.arabic,t.x,t.y+10),n.fillStyle="rgba(255, 255, 255, 0.2)",n.beginPath(),n.ellipse(t.x,t.y-12,a/4,3,0,0,Math.PI*2),n.fill()})}function w(t,a){for(let e=0;e<20;e++)r.push({x:t,y:a,vx:(Math.random()-.5)*8,vy:(Math.random()-.5)*8,life:1,size:Math.random()*3+2,color:x[Math.floor(Math.random()*x.length)]})}function L(){const t=document.getElementById("rainInput");if(!t)return;const a=t.value.trim().toLowerCase();if(t.value="",!a)return;const e=l.findIndex(i=>i.swedish.toLowerCase()===a);if(e!==-1){const i=l[e];w(i.x,i.y),l.splice(e,1),s+=10;const c=document.getElementById("rainScore");c&&(c.textContent=String(s)),t.classList.add("correct-flash"),setTimeout(()=>t.classList.remove("correct-flash"),300),typeof TTSManager<"u"&&TTSManager&&TTSManager.speak(a,"sv")}else t.classList.add("wrong-flash"),setTimeout(()=>t.classList.remove("wrong-flash"),300),typeof soundManager<"u"&&(soundManager!=null&&soundManager.playError)&&soundManager.playError()}function R(){m=!1,g&&cancelAnimationFrame(g);const t=document.getElementById("rainFinalScore"),a=document.getElementById("rainGameOver"),e=document.getElementById("rainInput");t&&(t.textContent=String(s)),a&&a.classList.remove("hidden"),e&&(e.disabled=!0),typeof saveScore=="function"&&saveScore("rain",s)}window.initRainGame=p;
