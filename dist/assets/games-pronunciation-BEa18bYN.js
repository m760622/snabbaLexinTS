import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{b as a,c as g,a as p}from"./games-utils-ByroIWVH.js";import{T as d}from"./tts-BPLy4HEw.js";import"./config-CfHoVMbv.js";console.log("pronunciationGame.ts LOADED");let s=null,f=0,l=!1,r=null;function m(){if("webkitSpeechRecognition"in window)r=new webkitSpeechRecognition;else if("SpeechRecognition"in window)r=new SpeechRecognition;else return;r.lang="sv-SE",r.continuous=!1,r.interimResults=!1,r.onresult=w,r.onerror=k,r.onend=()=>{l=!1,y()}}function B(){const e=document.getElementById("pronunciationWord"),o=document.getElementById("pronunciationTranslation"),i=document.getElementById("pronunciationFeedback"),n=document.getElementById("nextPronunciationBtn");if(!e||!o||!i)return;i.innerHTML="",i.className="pronunciation-feedback",n&&(n.style.display="none");let t=null,u=0;for(;!t&&u<200;){const c=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];c&&c[a]&&c[g]&&c[a].length>=3&&c[a].length<=12&&!c[a].includes(" ")&&(t=c),u++}if(!t){e.textContent="Fel",o.textContent="Kunde inte hitta ett ord";return}s=t[a].toLowerCase(),e.textContent=t[a],o.textContent=t[g],r||m(),typeof d<"u"&&d&&setTimeout(()=>d.speak(t[a],"sv"),500)}function h(){if(!r&&(m(),!r)){E("Tyvärr stöds inte tal i denna webbläsare","error");return}if(l)r.stop(),l=!1;else try{r.start(),l=!0}catch(e){console.error("Speech recognition error:",e)}y()}function y(){const e=document.getElementById("micBtn"),o=document.getElementById("micStatus");!e||!o||(l?(e.classList.add("listening"),o.textContent="Lyssnar... / أستمع..."):(e.classList.remove("listening"),o.textContent="Tryck för att tala / اضغط للتحدث"))}function w(e){const o=document.getElementById("pronunciationFeedback"),i=document.getElementById("nextPronunciationBtn"),n=document.getElementById("pronunciationScore");if(!o||!s)return;let t="";for(let c=e.resultIndex;c<e.results.length;c++)t+=e.results[c][0].transcript;t=t.toLowerCase().trim(),console.log("Heard:",t,"Target:",s),t.includes(s)||s.includes(t)||S(t,s)<=2?(o.innerHTML=`✅ Bra uttal! / نطق ممتاز!<br><span style="opacity:0.7">Du sa: "${t}"</span>`,o.className="pronunciation-feedback success",f++,n&&(n.textContent=String(f)),typeof p=="function"&&p("pronunciation",f)):(o.innerHTML=`⚠️ Försök igen!<br><span style="opacity:0.7">Du sa: "${t}"</span>`,o.className="pronunciation-feedback warning"),i&&(i.style.display="block")}function k(e){console.error("Speech error:",e.error),E(`Fel: ${e.error}`,"error")}function E(e,o){const i=document.getElementById("pronunciationFeedback");i&&(i.textContent=e,i.className=`pronunciation-feedback ${o}`)}function S(e,o){if(e.length===0)return o.length;if(o.length===0)return e.length;const i=[];for(let n=0;n<=o.length;n++)i[n]=[n];for(let n=0;n<=e.length;n++)i[0][n]=n;for(let n=1;n<=o.length;n++)for(let t=1;t<=e.length;t++)o.charAt(n-1)===e.charAt(t-1)?i[n][t]=i[n-1][t-1]:i[n][t]=Math.min(i[n-1][t-1]+1,i[n][t-1]+1,i[n-1][t]+1);return i[o.length][e.length]}document.addEventListener("DOMContentLoaded",()=>{m();const e=document.getElementById("micBtn");e&&(e.onclick=h)});window.startPronunciationGame=B;window.toggleMic=h;
