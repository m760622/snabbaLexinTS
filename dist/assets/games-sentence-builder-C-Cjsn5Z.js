import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              *//* empty css                     */import"./loader-B7oZEySq.js";import{s as g,a as h}from"./games-utils-C1tirr9C.js";import{A as s}from"./config-CfHoVMbv.js";import{T as f}from"./tts-BuOrQ7kI.js";import{t as d}from"./i18n-Dru8U3nj.js";import"./db-bEbbjtoI.js";import"./toast-manager-B6dAfcdf.js";console.log("sentenceBuilderGame.ts LOADED");let y=[],B=[],E=0;function p(e=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){e<10?(console.warn(`Data not ready for Sentence Builder. Retrying (${e+1}/10)...`),typeof g=="function"&&g(d("common.loading"),"info"),setTimeout(()=>p(e+1),500)):(console.error("Critical: Data failed to load for Sentence Builder."),typeof g=="function"&&g(d("common.error"),"error"));return}const t=document.getElementById("sentenceHint"),n=document.getElementById("sentenceDropZone"),o=document.getElementById("sentenceWordBank"),c=document.getElementById("sentenceFeedback"),i=document.getElementById("nextSentenceBtn"),r=document.getElementById("checkSentenceBtn");if(!t||!n||!o||!c)return;c.innerHTML="",c.className="game-feedback",i&&(i.style.display="none"),r&&(r.style.display="block"),n.innerHTML=`<div class="drop-placeholder">${d("games.dragHere")}</div>`,o.innerHTML="",B=[];let l=null,S=0;for(;!l&&S<200;){const a=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];a&&a[s.COLUMNS.EXAMPLE_SWE]&&a[s.COLUMNS.EXAMPLE_SWE].split(" ").length>=3&&a[s.COLUMNS.EXAMPLE_SWE].split(" ").length<=8&&(l=a),S++}if(!l){t.textContent=d("details.noWordFound");return}const k=l[s.COLUMNS.EXAMPLE_SWE],I=l[s.COLUMNS.EXAMPLE_ARB]||l[s.COLUMNS.ARABIC]||"";t.innerHTML=`<span style="display: block;">${I}</span>`,y=k.split(" ").filter(a=>a.length>0),[...y].sort(()=>Math.random()-.5).forEach(a=>{const u=document.createElement("button");u.className="sentence-word",u.textContent=a,u.onclick=()=>L(u,a),o.appendChild(u)}),r&&(r.onclick=M)}function L(e,t){const n=document.getElementById("sentenceDropZone"),o=document.getElementById("sentenceWordBank");if(!n||!o)return;const c=n.querySelector(".drop-placeholder");if(e.parentElement===o)c&&c.remove(),n.appendChild(e),B.push(t);else{o.appendChild(e);const i=B.indexOf(t);i>-1&&B.splice(i,1),n.children.length===0&&(n.innerHTML=`<div class="drop-placeholder">${d("games.dragHere")}</div>`)}}function M(){const e=document.getElementById("sentenceFeedback"),t=document.getElementById("nextSentenceBtn"),n=document.getElementById("checkSentenceBtn"),o=document.getElementById("sentenceDropZone"),c=document.getElementById("sentenceScore");if(!o||!e)return;const i=Array.from(o.querySelectorAll(".sentence-word")).map(l=>l.textContent).join(" "),r=y.join(" ");i===r?(e.textContent=`âœ… ${d("games.perfect")}`,e.className="game-feedback success",E++,c&&(c.textContent=String(E)),typeof h=="function"&&h("sentence",E),typeof f<"u"&&f&&f.speak(r,"sv"),t&&(t.style.display="block"),n&&(n.style.display="none")):(e.textContent=`âŒ ${d("games.notQuite")}`,e.className="game-feedback error")}function v(){const e=document.getElementById("sentenceDropZone"),t=document.getElementById("sentenceWordBank"),n=document.getElementById("sentenceFeedback"),o=document.getElementById("nextSentenceBtn"),c=document.getElementById("checkSentenceBtn");!e||!t||!n||(e.innerHTML="",t.innerHTML="",y.forEach(i=>{const r=document.createElement("span");r.className="sentence-word correct",r.textContent=i,e.appendChild(r)}),n.innerHTML=`ðŸ“– ${d("games.correctOrder")}`,n.className="game-feedback",typeof f<"u"&&f&&f.speak(y.join(" "),"sv"),o&&(o.style.display="block"),c&&(c.style.display="none"))}let m=!1;function C(){if(m)return;if(typeof dictionaryData<"u"&&dictionaryData.length>0){console.log("[SentenceBuilder] Data already available, starting game..."),m=!0,p();return}let e=0;const t=50,n=setInterval(()=>{if(m){clearInterval(n);return}e++,typeof dictionaryData<"u"&&dictionaryData.length>0?(console.log("[SentenceBuilder] Data found via polling, starting game..."),clearInterval(n),m=!0,p()):e>=t&&(console.error("[SentenceBuilder] Timeout waiting for dictionary data"),clearInterval(n),g(d("common.error"),"error"))},100);console.log("[SentenceBuilder] Waiting for dictionaryLoaded event..."),window.addEventListener("dictionaryLoaded",()=>{m||(console.log("[SentenceBuilder] dictionaryLoaded event received, starting game..."),clearInterval(n),m=!0,p())},{once:!0})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("nextSentenceBtn");e&&(e.onclick=()=>p()),C()});window.startSentenceGame=p;window.showSentenceAnswer=v;
