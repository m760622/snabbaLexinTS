import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{s as c,a as C}from"./games-utils-ByroIWVH.js";import{A as n}from"./config-CfHoVMbv.js";import{generateEducationalSentence as I}from"./utils-B-9iATqE.js";import{T as u}from"./tts-BPLy4HEw.js";console.log("spellingGame.ts LOADED");let l=null,E=0,d=0;function B(i=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){i<10?(console.warn(`Data not ready for Spelling. Retrying (${i+1}/10)...`),typeof c=="function"&&c("Laddar speldata... / Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...","info"),setTimeout(()=>B(i+1),500)):(console.error("Critical: Data failed to load for Spelling."),typeof c=="function"&&c("Kunde inte ladda data. Uppdatera sidan. / ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.","error"));return}E=0,d=0,h(),H()}function h(){const i=document.getElementById("spellingScore"),t=document.getElementById("spellingStreak");i&&(i.textContent=String(E)),t&&(t.textContent=String(d))}function H(){const i=document.getElementById("spellingHint"),t=document.getElementById("spellingExample"),a=document.getElementById("spellingOptions"),o=document.getElementById("spellingFeedback"),S=document.getElementById("nextSpellingBtn"),m=document.getElementById("spHintBtn");if(!i||!a||!o)return;o.innerHTML="",o.className="sp-feedback",S&&S.classList.add("hidden"),m&&m.classList.remove("hidden"),a.innerHTML='<div class="sp-loading"><div class="sp-loading-spinner"></div><span>Laddar...</span></div>';let s=null,y=0;for(;!s&&y<200;){const e=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];e&&e[n.COLUMNS.SWEDISH]&&e[n.COLUMNS.ARABIC]&&e[n.COLUMNS.SWEDISH].length>2&&e[n.COLUMNS.SWEDISH].length<15&&(s=e),y++}if(!s){i.textContent="Kunde inte hitta ett ord. FÃ¶rsÃ¶k igen.",t&&(t.textContent=""),a.innerHTML='<button class="spelling-option-btn" onclick="loadSpellingQuestion()">FÃ¶rsÃ¶k igen</button>';return}l=s;const p=s[n.COLUMNS.SWEDISH],L=s[n.COLUMNS.ARABIC];i.textContent=L,t&&(t.textContent="");const r=[p];let M=0;for(;r.length<4&&M<100;){const e=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];e&&e[n.COLUMNS.SWEDISH]&&e[n.COLUMNS.SWEDISH]!==p&&!r.includes(e[n.COLUMNS.SWEDISH])&&e[n.COLUMNS.SWEDISH].length>2&&r.push(e[n.COLUMNS.SWEDISH]),M++}r.sort(()=>Math.random()-.5),setTimeout(()=>{a.innerHTML="",r.forEach((e,k)=>{const g=document.createElement("button");g.className="spelling-option-btn",g.textContent=e,g.style.animationDelay=`${k*.1}s`,g.onclick=()=>{typeof soundManager<"u"&&(soundManager!=null&&soundManager.playClick)&&soundManager.playClick(),w(e,p,g)},a.appendChild(g)})},300);const f=document.getElementById("spSpeakHint");f&&(f.onclick=()=>{typeof u<"u"&&u&&u.speak(p,"sv")})}function w(i,t,a){const o=document.getElementById("spellingFeedback"),S=document.getElementById("nextSpellingBtn"),m=document.getElementById("spHintBtn"),s=document.querySelectorAll(".spelling-option-btn");if(!o||!l)return;s.forEach(e=>e.disabled=!0),m&&m.classList.add("hidden");const y=l[n.COLUMNS.ARABIC]||"",p=l[n.COLUMNS.EXAMPLE_SWE]||"",L=l[n.COLUMNS.EXAMPLE_ARB]||"",r=l[n.COLUMNS.DEFINITION]||"",M=l[n.COLUMNS.TYPE]||"ord";let f="";if(typeof I=="function"){const e=I(t,y,p,L,r,M);f+=`<div class="sp-example-sentence">
            <div class="sp-sentence-swe">ðŸ“– ${e.s}</div>
            <div class="sp-sentence-arb calc-text-size">${e.a}</div>
        </div>`}i===t?(a.classList.add("correct"),E++,d++,h(),typeof HapticManager<"u"&&HapticManager?HapticManager.trigger("success"):navigator.vibrate&&navigator.vibrate([50,30,50]),typeof soundManager<"u"&&(soundManager!=null&&soundManager.playSuccess)&&soundManager.playSuccess(),o.innerHTML=f,o.className="sp-feedback success",window.TextSizeManager&&window.TextSizeManager.applyRules(),typeof C=="function"&&C("spelling",E),d>=3&&d%3===0&&typeof c=="function"&&c(`ðŸ”¥ ${d} i rad! / ${d} Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ!`,"success")):(a.classList.add("wrong"),s.forEach(e=>{e.textContent===t&&setTimeout(()=>e.classList.add("correct"),300)}),o.innerHTML=f,o.className="sp-feedback",d=0,h(),typeof soundManager<"u"&&(soundManager!=null&&soundManager.playError)&&soundManager.playError()),typeof u<"u"&&u&&u.speak(t,"sv"),S&&S.classList.remove("hidden")}function D(){if(!l)return;const t=l[n.COLUMNS.SWEDISH].charAt(0).toUpperCase();typeof c=="function"&&c(`ðŸ’¡ FÃ¶rsta bokstaven: ${t}`,"info");const a=document.getElementById("spHintBtn");a&&(a.disabled=!0,a.style.opacity="0.5")}window.startSpellingGame=B;window.showSpellingHint=D;window.loadSpellingQuestion=H;
