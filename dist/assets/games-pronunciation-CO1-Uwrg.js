import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import"./games-utils-HTOXTqfV.js";console.log("pronunciationGame.ts LOADED");let a=null,u=0,s=!1,r=null;function d(){if("webkitSpeechRecognition"in window)r=new webkitSpeechRecognition;else if("SpeechRecognition"in window)r=new SpeechRecognition;else return;r.lang="sv-SE",r.continuous=!1,r.interimResults=!1,r.onresult=h,r.onerror=E,r.onend=()=>{s=!1,g()}}function p(){const e=document.getElementById("pronunciationWord"),o=document.getElementById("pronunciationTranslation"),i=document.getElementById("pronunciationFeedback"),n=document.getElementById("nextPronunciationBtn");if(!e||!o||!i)return;i.innerHTML="",i.className="pronunciation-feedback",n&&(n.style.display="none");let t=null,l=0;for(;!t&&l<200;){const c=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];c&&c[COL_SWE]&&c[COL_ARB]&&c[COL_SWE].length>=3&&c[COL_SWE].length<=12&&!c[COL_SWE].includes(" ")&&(t=c),l++}if(!t){e.textContent="Fel",o.textContent="Kunde inte hitta ett ord";return}a=t[COL_SWE].toLowerCase(),e.textContent=t[COL_SWE],o.textContent=t[COL_ARB],r||d(),typeof TTSManager<"u"&&TTSManager&&setTimeout(()=>TTSManager.speak(t[COL_SWE],"sv"),500)}function f(){if(!r&&(d(),!r)){m("Tyvärr stöds inte tal i denna webbläsare","error");return}if(s)r.stop(),s=!1;else try{r.start(),s=!0}catch(e){console.error("Speech recognition error:",e)}g()}function g(){const e=document.getElementById("micBtn"),o=document.getElementById("micStatus");!e||!o||(s?(e.classList.add("listening"),o.textContent="Lyssnar... / أستمع..."):(e.classList.remove("listening"),o.textContent="Tryck för att tala / اضغط للتحدث"))}function h(e){const o=document.getElementById("pronunciationFeedback"),i=document.getElementById("nextPronunciationBtn"),n=document.getElementById("pronunciationScore");if(!o||!a)return;let t="";for(let c=e.resultIndex;c<e.results.length;c++)t+=e.results[c][0].transcript;t=t.toLowerCase().trim(),console.log("Heard:",t,"Target:",a),t.includes(a)||a.includes(t)||y(t,a)<=2?(o.innerHTML=`✅ Bra uttal! / نطق ممتاز!<br><span style="opacity:0.7">Du sa: "${t}"</span>`,o.className="pronunciation-feedback success",u++,n&&(n.textContent=String(u)),typeof saveScore=="function"&&saveScore("pronunciation",u)):(o.innerHTML=`⚠️ Försök igen!<br><span style="opacity:0.7">Du sa: "${t}"</span>`,o.className="pronunciation-feedback warning"),i&&(i.style.display="block")}function E(e){console.error("Speech error:",e.error),m(`Fel: ${e.error}`,"error")}function m(e,o){const i=document.getElementById("pronunciationFeedback");i&&(i.textContent=e,i.className=`pronunciation-feedback ${o}`)}function y(e,o){if(e.length===0)return o.length;if(o.length===0)return e.length;const i=[];for(let n=0;n<=o.length;n++)i[n]=[n];for(let n=0;n<=e.length;n++)i[0][n]=n;for(let n=1;n<=o.length;n++)for(let t=1;t<=e.length;t++)o.charAt(n-1)===e.charAt(t-1)?i[n][t]=i[n-1][t-1]:i[n][t]=Math.min(i[n-1][t-1]+1,i[n][t-1]+1,i[n-1][t]+1);return i[o.length][e.length]}document.addEventListener("DOMContentLoaded",()=>{d();const e=document.getElementById("micBtn");e&&(e.onclick=f)});window.startPronunciationGame=p;window.toggleMic=f;
