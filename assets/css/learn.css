 :root {
     --primary: #3b82f6;
     --primary-dark: #2563eb;
     --bg-color: #0f172a;
     --card-bg: #1e293b;
     --text-color: #f8fafc;
     --text-muted: #94a3b8;
     --success: #22c55e;
     --warning: #f59e0b;
     --danger: #ef4444;
 }

 [data-theme="light"] {
     --bg-color: #f8fafc;
     --card-bg: #ffffff;
     --text-color: #1e293b;
     --text-muted: #64748b;
 }

 * {
     box-sizing: border-box;
     margin: 0;
     padding: 0;
 }

 body {
     font-family: 'Inter', sans-serif;
     background: var(--bg-color);
     color: var(--text-color);
     min-height: 100vh;
 }

 html.iphone-mode {
     background: var(--bg-color);
 }

 body.iphone-view {
     max-width: 393px;
     margin: 2rem auto;
     border: 12px solid #333;
     border-radius: 50px;
     min-height: calc(100vh - 4rem);
     box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
     overflow-x: hidden;
     position: relative;
 }

 body.iphone-view::before {
     /* Notch / Dynamic Island Simulation */
     content: "";
     position: absolute;
     top: 12px;
     left: 50%;
     transform: translateX(-50%);
     width: 120px;
     height: 35px;
     background-color: #000;
     border-bottom-left-radius: 20px;
     border-bottom-right-radius: 20px;
     z-index: 1000;
     pointer-events: none;
 }

 /* Header */
 header {
     display: flex;
     align-items: center;
     gap: 0.75rem;
     padding: 1rem 1.25rem;
     background: linear-gradient(135deg, rgba(59, 130, 246, 0.12) 0%, rgba(56, 189, 248, 0.12) 100%);
     -webkit-backdrop-filter: blur(20px);
     backdrop-filter: blur(20px);
     position: sticky;
     top: 0;
     z-index: 100;
     border-bottom: 1px solid rgba(56, 189, 248, 0.2);
     box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
 }

 .back-btn,
 

 .back-btn:hover {
     background: rgba(56, 189, 248, 0.3);
     transform: translateX(-3px);
 }

 

 

 header h1 {
     flex: 1;
     font-size: 1.1rem;
     text-align: center;
     background: linear-gradient(135deg, #38bdf8 0%, #3b82f6 50%, #60a5fa 100%);
     -webkit-background-clip: text;
     -webkit-text-fill-color: transparent;
     background-clip: text;
     font-weight: 700;
     letter-spacing: 0.02em;
 }

 /* Progress Hero */
 .progress-hero {
     background: linear-gradient(135deg, var(--primary) 0%, #38bdf8 100%);
     padding: 1.25rem;
     color: white;
 }

 .hero-stats {
     display: flex;
     justify-content: space-around;
     gap: 1rem;
     margin-bottom: 1rem;
 }

 .hero-stat {
     text-align: center;
 }

 .hero-stat .value {
     font-size: 1.5rem;
     font-weight: 700;
 }

 .hero-stat .label {
     font-size: 0.75rem;
     opacity: 0.9;
 }

 .overall-progress {
     background: rgba(255, 255, 255, 0.2);
     border-radius: 10px;
     height: 8px;
     overflow: hidden;
 }

 .overall-progress .fill {
     height: 100%;
     background: white;
     transition: width 0.5s;
 }

 .progress-text {
     font-size: 0.8rem;
     margin-top: 0.5rem;
     text-align: center;
     opacity: 0.9;
 }

 /* Review Banner */
 .review-banner {
     background: rgba(239, 68, 68, 0.15);
     border: 1px solid rgba(239, 68, 68, 0.3);
     border-radius: 12px;
     padding: 1rem;
     margin: 1rem;
     display: flex;
     align-items: center;
     gap: 1rem;
     cursor: pointer;
     transition: all 0.2s;
 }

 .review-banner:hover {
     background: rgba(239, 68, 68, 0.25);
 }

 .review-banner.hidden {
     display: none;
 }

 .review-icon {
     font-size: 2rem;
 }

 .review-content {
     flex: 1;
 }

 .review-title {
     font-weight: 600;
     color: var(--danger);
 }

 .review-subtitle {
     font-size: 0.85rem;
     color: var(--text-muted);
 }

 main {
     padding: 0 1rem 1rem;
     max-width: 700px;
     margin: 0 auto;
 }

 /* Search & Filter */
 .search-container {
     margin: 1rem 0 0.75rem;
 }

 #lessonSearchInput {
     width: 100%;
     padding: 0.75rem 1.25rem;
     border-radius: 50px;
     border: 2px solid rgba(59, 130, 246, 0.2);
     background: rgba(15, 23, 42, 0.6);
     color: var(--text-color);
     font-size: 1rem;
     transition: all 0.3s;
 }

 #lessonSearchInput:focus {
     outline: none;
     border-color: var(--primary);
     box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
 }

 .filter-scroll-container {
     display: flex;
     overflow-x: auto;
     gap: 0.5rem;
     padding: 0.5rem 0;
     scrollbar-width: none;
 }

 .filter-scroll-container::-webkit-scrollbar {
     display: none;
 }

 .filter-chip {
     padding: 0.4rem 0.9rem;
     border-radius: 20px;
     background: var(--card-bg);
     border: 1px solid rgba(59, 130, 246, 0.2);
     color: var(--text-muted);
     font-size: 0.85rem;
     white-space: nowrap;
     cursor: pointer;
     transition: all 0.2s;
 }

 .filter-chip.active {
     background: var(--primary);
     color: white;
     border-color: var(--primary);
 }

 /* Special Cards - Snabbsp√•r */
 .special-section {
     margin-bottom: 1.5rem;
     background: linear-gradient(135deg, rgba(30, 58, 95, 0.3) 0%, rgba(15, 23, 42, 0.4) 100%);
     -webkit-backdrop-filter: blur(10px);
     backdrop-filter: blur(10px);
     border-radius: 16px;
     padding: 1rem;
     border: 1px solid rgba(100, 150, 200, 0.15);
 }

 .section-title {
     font-size: 0.85rem;
     color: var(--text-muted);
     margin-bottom: 0.75rem;
     display: flex;
     align-items: center;
     gap: 0.5rem;
     padding-left: 0.25rem;
 }

 .special-cards {
     display: flex;
     gap: 0.5rem;
     overflow-x: auto;
     scrollbar-width: none;
 }

 .special-cards::-webkit-scrollbar {
     display: none;
 }

 .special-card {
     background: linear-gradient(135deg, rgba(30, 58, 95, 0.5) 0%, rgba(15, 23, 42, 0.6) 100%);
     -webkit-backdrop-filter: blur(8px);
     backdrop-filter: blur(8px);
     border-radius: 12px;
     padding: 0.75rem 1rem;
     cursor: pointer;
     transition: all 0.25s ease;
     border: 1px solid rgba(100, 150, 200, 0.2);
     text-align: center;
     flex: 1;
     min-width: 0;
     display: flex;
     flex-direction: column;
     align-items: center;
     gap: 0.25rem;
 }

 .special-card:hover {
     border-color: rgba(100, 150, 200, 0.4);
     transform: translateY(-2px);
     background: linear-gradient(135deg, rgba(40, 70, 110, 0.6) 0%, rgba(20, 35, 60, 0.7) 100%);
     box-shadow: 0 8px 20px rgba(15, 30, 60, 0.3);
 }

 .special-card .icon {
     font-size: 1.5rem;
     margin-bottom: 0;
 }

 .special-card .title {
     font-weight: 600;
     font-size: 0.75rem;
     margin-bottom: 0;
     white-space: nowrap;
     overflow: hidden;
     text-overflow: ellipsis;
     width: 100%;
 }

 .special-card .subtitle {
     font-size: 0.65rem;
     color: var(--text-muted);
     white-space: nowrap;
     overflow: hidden;
     text-overflow: ellipsis;
     width: 100%;
 }

 /* Lesson Cards */
 .lessons-grid {
     display: grid;
     gap: 0.75rem;
 }

 .lesson-card {
     background: var(--card-bg);
     border-radius: 14px;
     padding: 1rem;
     cursor: pointer;
     transition: all 0.3s;
     border: 1px solid rgba(59, 130, 246, 0.1);
     position: relative;
     display: flex;
     gap: 1rem;
     align-items: center;
 }

 .lesson-card:hover {
     transform: translateY(-2px);
     border-color: var(--primary);
     box-shadow: 0 10px 30px -10px rgba(59, 130, 246, 0.3);
 }

 .lesson-card.completed {
     border-color: var(--success);
     background: rgba(34, 197, 94, 0.05);
 }

 .lesson-card.locked {
     opacity: 0.5;
     pointer-events: none;
 }

 .lesson-icon {
     font-size: 2.25rem;
     flex-shrink: 0;
 }

 .lesson-info {
     flex: 1;
 }

 .lesson-title {
     font-size: 1rem;
     font-weight: 600;
     margin-bottom: 0.2rem;
 }

 .lesson-subtitle {
     font-size: 0.85rem;
     color: var(--primary);
     font-family: 'IBM Plex Sans Arabic', sans-serif;
 }

 .lesson-desc {
     font-size: 0.8rem;
     color: var(--text-muted);
     margin-top: 0.35rem;
     line-height: 1.4;
 }

 .lesson-badge {
     position: absolute;
     top: -8px;
     right: -8px;
     background: var(--success);
     color: white;
     width: 24px;
     height: 24px;
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
     font-size: 0.8rem;
 }

 .lesson-progress {
     position: absolute;
     bottom: 0;
     left: 0;
     right: 0;
     height: 3px;
     background: rgba(59, 130, 246, 0.2);
     border-radius: 0 0 14px 14px;
     overflow: hidden;
 }

 .lesson-progress .fill {
     height: 100%;
     background: var(--primary);
     transition: width 0.3s;
 }

 /* Star Ratings */
 .lesson-stars {
     display: flex;
     gap: 0.1rem;
     margin-top: 0.5rem;
     font-size: 0.9rem;
     justify-content: center;
 }

 /* Progress States */
 .lesson-card.started {
     border-left: 3px solid var(--primary);
 }

 .lesson-card.practiced {
     border-left: 3px solid var(--warning);
 }

 .lesson-card.mastered {
     border-left: 3px solid var(--success);
     background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, var(--card-bg) 100%);
 }

 /* Badge Variants */
 .lesson-badge.warning-badge {
     background: rgba(239, 68, 68, 0.2);
     color: #ef4444;
 }

 .lesson-badge.tips-badge {
     background: rgba(245, 158, 11, 0.2);
     color: #f59e0b;
 }


 .level-badge {
     padding: 0.2rem 0.5rem;
     border-radius: 10px;
     font-size: 0.7rem;
     font-weight: 600;
 }

 .level-badge.beginner {
     background: rgba(34, 197, 94, 0.2);
     color: var(--success);
 }

 .level-badge.intermediate {
     background: rgba(245, 158, 11, 0.2);
     color: var(--warning);
 }

 .level-badge.advanced {
     background: rgba(239, 68, 68, 0.2);
     color: var(--danger);
 }

 /* Lesson Modal */
 .lesson-modal {
     display: none;
     position: fixed;
     top: 0;
     left: 0;
     right: 0;
     bottom: 0;
     background: var(--bg-color);
     z-index: 200;
     overflow-y: auto;
 }

 .lesson-modal.active {
     display: block;
 }

 .modal-header {
     position: fixed;
     top: 0;
     left: 0;
     right: 0;
     display: flex;
     align-items: center;
     gap: 0.75rem;
     padding: 0.75rem 1rem;
     background: var(--bg-color);
     border-bottom: 1px solid rgba(255, 255, 255, 0.1);
     z-index: 300;
 }

 .close-lesson {
     background: var(--card-bg);
     border: none;
     color: var(--text-color);
     width: 36px;
     height: 36px;
     border-radius: 50%;
     font-size: 1.25rem;
     cursor: pointer;
 }

 .modal-header h2 {
     font-size: 1.1rem;
     background: linear-gradient(135deg, #38bdf8 0%, #3b82f6 50%, #60a5fa 100%);
     -webkit-background-clip: text;
     -webkit-text-fill-color: transparent;
     background-clip: text;
     font-weight: 700;
     flex: 1;
 }

 .lesson-content {
     max-width: 700px;
     margin: 0 auto;
     padding: 4.5rem 1rem 2rem;
 }

 .lesson-section {
     background: var(--card-bg);
     border-radius: 12px;
     padding: 1.25rem;
     margin-bottom: 1rem;
 }

 .lesson-section h3 {
     font-size: 0.95rem;
     margin-bottom: 0.75rem;
     display: flex;
     align-items: center;
     gap: 0.5rem;
 }

 .lesson-section p {
     color: var(--text-muted);
     line-height: 1.6;
     margin-bottom: 0.75rem;
     font-size: 0.9rem;
 }

 .example-box {
     background: rgba(59, 130, 246, 0.1);
     border-left: 3px solid var(--primary);
     padding: 0.9rem;
     border-radius: 0 8px 8px 0;
     margin: 0.75rem 0;
 }

 .example-box .swe {
     font-size: 1rem;
     margin-bottom: 0.25rem;
     display: flex;
     align-items: center;
     gap: 0.5rem;
 }

 .example-box .arb {
     color: var(--text-muted);
     font-family: 'IBM Plex Sans Arabic', sans-serif;
     direction: rtl;
     font-size: 0.9rem;
 }

 .speak-btn {
     background: none;
     border: none;
     cursor: pointer;
     font-size: 1.2rem;
     opacity: 0.8;
 }

 .speak-btn:hover {
     opacity: 1;
     transform: scale(1.1);
 }

 .rule-highlight {
     background: linear-gradient(135deg, var(--primary) 0%, #38bdf8 100%);
     color: white;
     padding: 1rem;
     border-radius: 8px;
     text-align: center;
     font-size: 1rem;
     margin: 0.75rem 0;
 }

 .rule-highlight strong {
     color: #fef08a;
 }

 /* Quiz Styles */
 .lesson-completion {
     margin-top: 2rem;
     text-align: center;
 }

 .quiz-start-btn {
     background: var(--primary);
     color: white;
     border: none;
     padding: 0.9rem 2rem;
     border-radius: 50px;
     font-size: 1rem;
     font-weight: 600;
     cursor: pointer;
     box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
     transition: all 0.3s;
     display: inline-flex;
     align-items: center;
     gap: 0.5rem;
 }

 .quiz-start-btn:hover {
     transform: translateY(-2px);
     box-shadow: 0 8px 25px rgba(59, 130, 246, 0.5);
 }

 .quiz-container {
     max-width: 600px;
     margin: 0 auto;
     text-align: center;
 }

 .quiz-header {
     margin-bottom: 1.5rem;
 }

 .progress-bar {
     height: 6px;
     background: #334155;
     border-radius: 3px;
     margin-top: 0.75rem;
     overflow: hidden;
 }

 .progress-bar div {
     height: 100%;
     background: var(--primary);
     transition: width 0.3s;
 }

 .question-card {
     background: var(--card-bg);
     padding: 1.5rem;
     border-radius: 16px;
 }

 .question-text {
     font-size: 1.1rem;
     margin-bottom: 1.5rem;
     font-weight: 600;
 }

 .options-grid {
     display: grid;
     gap: 0.75rem;
 }

 .option-btn {
     background: var(--bg-color);
     border: 2px solid rgba(59, 130, 246, 0.1);
     padding: 0.9rem;
     border-radius: 8px;
     font-size: 0.95rem;
     cursor: pointer;
     transition: all 0.2s;
     color: var(--text-color);
     font-family: inherit;
 }

 .option-btn:hover {
     border-color: var(--primary);
     background: rgba(59, 130, 246, 0.05);
 }

 .option-btn.correct-answer {
     background: rgba(34, 197, 94, 0.2) !important;
     border-color: #22c55e !important;
     color: #22c55e !important;
 }

 .option-btn.wrong-answer {
     background: rgba(239, 68, 68, 0.2) !important;
     border-color: #ef4444 !important;
     color: #ef4444 !important;
     animation: shake 0.5s;
 }

 .option-btn:disabled {
     cursor: not-allowed;
     opacity: 0.8;
 }

 @keyframes shake {

     0%,
     100% {
         transform: translateX(0);
     }

     20%,
     60% {
         transform: translateX(-5px);
     }

     40%,
     80% {
         transform: translateX(5px);
     }
 }

 .answer-feedback {
     margin-top: 1.25rem;
     padding: 1rem;
     border-radius: 12px;
     text-align: center;
     font-weight: 600;
     animation: fadeIn 0.3s;
 }

 .feedback-correct-box {
     background: rgba(34, 197, 94, 0.15);
     border: 2px solid #22c55e;
     color: #22c55e;
 }

 .feedback-wrong-box {
     background: rgba(239, 68, 68, 0.15);
     border: 2px solid #ef4444;
     color: #ef4444;
 }

 @keyframes fadeIn {
     from {
         opacity: 0;
         transform: translateY(-10px);
     }

     to {
         opacity: 1;
         transform: translateY(0);
     }
 }

 /* Writing Quiz Styles */
 .writing-quiz {
     text-align: center;
 }

 .writing-input-container {
     display: flex;
     gap: 0.5rem;
     margin-top: 1.5rem;
 }

 .writing-input {
     flex: 1;
     padding: 0.9rem 1rem;
     border: 2px solid rgba(59, 130, 246, 0.3);
     border-radius: 12px;
     background: var(--bg-color);
     color: var(--text-color);
     font-size: 1.1rem;
     text-align: center;
     transition: all 0.3s;
 }

 .writing-input:focus {
     outline: none;
     border-color: var(--primary);
     box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
 }

 .writing-input.correct-input {
     border-color: #22c55e;
     background: rgba(34, 197, 94, 0.1);
 }

 .writing-input.wrong-input {
     border-color: #ef4444;
     background: rgba(239, 68, 68, 0.1);
     animation: shake 0.5s;
 }

 .check-writing-btn {
     padding: 0.9rem 1.25rem;
     background: var(--primary);
     color: white;
     border: none;
     border-radius: 12px;
     font-size: 0.95rem;
     font-weight: 600;
     cursor: pointer;
     transition: all 0.3s;
     white-space: nowrap;
 }

 .check-writing-btn:hover {
     background: var(--primary-dark);
     transform: translateY(-2px);
 }

 .check-writing-btn:disabled {
     opacity: 0.6;
     cursor: not-allowed;
 }

 .writing-feedback {
     margin-top: 1rem;
     padding: 0.75rem;
     text-align: center;
     font-weight: 600;
     animation: fadeIn 0.3s;
 }

 /* Sentence Fill Quiz Styles */
 .sentence-fill-quiz {
     text-align: center;
 }

 .sentence-container {
     background: var(--bg-color);
     border: 2px solid rgba(59, 130, 246, 0.2);
     border-radius: 12px;
     padding: 1.5rem;
     margin-bottom: 2rem;
     display: flex;
     justify-content: center;
     align-items: center;
     flex-wrap: wrap;
     gap: 0.5rem;
     min-height: 80px;
 }

 .sentence-word {
     display: inline-block;
     padding: 0.3rem 0.5rem;
     font-size: 1.2rem;
     border-radius: 4px;
 }

 .sentence-gap {
     display: inline-block;
     min-width: 100px;
     height: 40px;
     border-bottom: 2px dashed var(--primary);
     vertical-align: middle;
     margin: 0 0.5rem;
     color: var(--primary);
     font-weight: bold;
     text-align: center;
     line-height: 40px;
 }

 .sentence-gap.filled {
     border-bottom: 2px solid var(--success);
     color: var(--success);
     animation: fadeIn 0.3s;
 }

 /* Audio Quiz Styles */
 .audio-quiz {
     text-align: center;
 }

 .audio-player-large {
     background: var(--bg-color);
     width: 80px;
     height: 80px;
     border-radius: 50%;
     display: flex;
     align-items: center;
     justify-content: center;
     margin: 0 auto 2rem;
     cursor: pointer;
     box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
     transition: all 0.3s;
 }

 .audio-player-large:hover {
     transform: scale(1.1);
     background: var(--primary);
     color: white;
     box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
 }

 .audio-player-large.playing {
     animation: pulse-ring 1.5s infinite;
 }

 .audio-player-large svg {
     width: 40px;
     height: 40px;
 }

 @keyframes pulse-ring {
     0% {
         box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
     }

     70% {
         box-shadow: 0 0 0 20px rgba(59, 130, 246, 0);
     }

     100% {
         box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
     }
 }

 /* Reward Modal */
 .reward-modal {
     display: none;
     position: fixed;
     top: 0;
     left: 0;
     right: 0;
     bottom: 0;
     background: rgba(0, 0, 0, 0.9);
     z-index: 500;
     align-items: center;
     justify-content: center;
 }

 .reward-modal.active {
     display: flex;
     animation: fadeIn 0.5s;
 }

 .reward-content {
     background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
     padding: 2.5rem;
     border-radius: 16px;
     text-align: center;
     max-width: 90%;
     width: 360px;
     position: relative;
     border: 1px solid rgba(100, 150, 200, 0.2);
     box-shadow:
         0 0 40px rgba(15, 30, 60, 0.5),
         0 20px 40px -12px rgba(0, 0, 0, 0.5);
     animation: slideInUp 0.5s cubic-bezier(0.16, 1, 0.3, 1);
     overflow: hidden;
 }

 .reward-content::before {
     content: '';
     position: absolute;
     top: 0;
     left: 0;
     right: 0;
     height: 1px;
     background: linear-gradient(90deg, transparent, rgba(148, 163, 184, 0.3), transparent);
 }

 .reward-content::after {
     content: '';
     position: absolute;
     top: -50%;
     left: -50%;
     width: 200%;
     height: 200%;
     background: radial-gradient(circle at center, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
     pointer-events: none;
     animation: pulse-glow 3s ease-in-out infinite;
 }

 @keyframes pulse-glow {

     0%,
     100% {
         opacity: 0.3;
         transform: scale(1);
     }

     50% {
         opacity: 0.5;
         transform: scale(1.05);
     }
 }

 @keyframes slideInUp {
     from {
         transform: translateY(50px);
         opacity: 0;
     }

     to {
         transform: translateY(0);
         opacity: 1;
     }
 }

 .reward-icon {
     font-size: 5rem;
     margin-bottom: 1rem;
     animation: bounce 2s infinite;
 }

 @keyframes bounce {

     0%,
     100% {
         transform: translateY(0);
     }

     50% {
         transform: translateY(-15px);
     }
 }

 .reward-title {
     font-size: 1.4rem;
     color: var(--text-color);
     margin-bottom: 0.5rem;
     font-weight: 600;
     position: relative;
     z-index: 1;
 }

 .reward-score {
     font-size: 2.25rem;
     font-weight: 700;
     color: var(--text-color);
     margin: 1rem 0;
     position: relative;
     z-index: 1;
 }

 .xp-gain {
     color: var(--primary);
     font-weight: 600;
     font-size: 1.1rem;
     padding: 0.4rem 0.8rem;
     background: rgba(59, 130, 246, 0.1);
     border-radius: 16px;
     display: inline-block;
     position: relative;
     z-index: 1;
 }

 .reward-btn {
     background: var(--primary);
     color: white;
     border: none;
     padding: 1rem 2rem;
     border-radius: 50px;
     font-size: 1rem;
     font-weight: 600;
     cursor: pointer;
     width: 100%;
     margin-top: 1.5rem;
     transition: all 0.3s ease;
     position: relative;
     z-index: 1;
 }

 .reward-btn:hover {
     transform: translateY(-2px);
     box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
 }

 .reward-btn:active {
     transform: translateY(0);
 }

 /* Confetti */
 .confetti {
     position: fixed;
     width: 10px;
     height: 10px;
     background-color: #f00;
     animation: confetti 5s ease-in-out infinite;
     z-index: 400;
 }

 @keyframes confetti {
     0% {
         transform: translateY(-10vh) rotate(0deg);
         opacity: 1;
     }

     100% {
         transform: translateY(110vh) rotate(720deg);
         opacity: 0;
     }
 }

 /* ========================================
   MOBILE RESPONSIVE STYLES - LEARN PAGE
   ======================================== */

 @media (max-width: 480px) {

     /* Header */
     header {
         padding: 0.75rem 1rem;
         gap: 0.5rem;
     }

     header h1 {
         font-size: 0.95rem;
     }

     .back-btn,
     

     /* Progress Hero */
     .progress-hero {
         padding: 1rem;
     }

     .hero-stats {
         gap: 0.5rem;
     }

     .hero-stat .value {
         font-size: 1.25rem;
     }

     .hero-stat .label {
         font-size: 0.65rem;
     }

     /* Main Content */
     main {
         padding: 0 0.75rem 1rem;
     }

     /* Search */
     .search-container {
         margin: 0.75rem 0 0.5rem;
     }

     #lessonSearchInput {
         padding: 0.65rem 1rem;
         font-size: 16px;
         /* Prevents zoom on iOS */
     }

     /* Filter Chips */
     .filter-scroll-container {
         gap: 0.35rem;
         padding: 0.35rem 0;
     }

     .filter-chip {
         padding: 0.35rem 0.75rem;
         font-size: 0.8rem;
     }

     /* Special Section */
     .special-section {
         padding: 0.75rem;
         margin-bottom: 1rem;
     }

     .section-title {
         font-size: 0.8rem;
         margin-bottom: 0.5rem;
     }

     .special-cards {
         gap: 0.4rem;
     }

     .special-card {
         padding: 0.6rem 0.75rem;
         border-radius: 10px;
     }

     .special-card .icon {
         font-size: 1.25rem;
     }

     .special-card .title {
         font-size: 0.7rem;
     }

     .special-card .subtitle {
         font-size: 0.6rem;
     }

     /* Lesson Cards */
     .lessons-grid {
         gap: 0.6rem;
     }

     .lesson-card {
         padding: 0.85rem;
         gap: 0.75rem;
         border-radius: 12px;
     }

     .lesson-icon {
         font-size: 1.75rem;
     }

     .lesson-title {
         font-size: 0.9rem;
     }

     .lesson-subtitle {
         font-size: 0.8rem;
     }

     .lesson-desc {
         font-size: 0.75rem;
     }

     .level-badge {
         font-size: 0.65rem;
         padding: 0.15rem 0.4rem;
     }

     /* Modal */
     .modal-header {
         padding: 0.6rem 0.75rem;
     }

     .modal-header h2 {
         font-size: 0.95rem;
     }

     .lesson-content {
         padding: 4rem 0.75rem 1.5rem;
     }

     .lesson-section {
         padding: 1rem;
         margin-bottom: 0.75rem;
         border-radius: 10px;
     }

     .lesson-section h3 {
         font-size: 0.9rem;
     }

     .lesson-section p {
         font-size: 0.85rem;
     }

     .example-box {
         padding: 0.75rem;
     }

     .example-box .swe {
         font-size: 0.9rem;
     }

     .example-box .arb {
         font-size: 0.85rem;
     }

     .rule-highlight {
         padding: 0.85rem;
         font-size: 0.9rem;
     }

     /* Quiz */
     .quiz-container {
         padding: 0 0.5rem;
     }

     .question-card {
         padding: 1.25rem;
         border-radius: 14px;
     }

     .question-text {
         font-size: 1rem;
         margin-bottom: 1.25rem;
     }

     .options-grid {
         gap: 0.6rem;
     }

     .option-btn {
         padding: 0.75rem;
         font-size: 0.9rem;
         border-radius: 8px;
     }

     .quiz-start-btn {
         padding: 0.8rem 1.75rem;
         font-size: 0.95rem;
     }

     /* Review Banner */
     .review-banner {
         margin: 0.75rem;
         padding: 0.85rem;
         gap: 0.75rem;
     }

     .review-icon {
         font-size: 1.5rem;
     }

     .review-title {
         font-size: 0.9rem;
     }

     .review-subtitle {
         font-size: 0.8rem;
     }

     /* Results */
     .quiz-results {
         padding: 1.25rem;
     }

     .result-emoji {
         font-size: 3rem;
     }

     .result-title {
         font-size: 1.25rem;
     }

     .result-score .score-number {
         font-size: 2rem;
     }
 }

 /* Touch-friendly improvements for Learn page */
 @media (hover: none) and (pointer: coarse) {

     .lesson-card,
     .special-card,
     .filter-chip,
     .option-btn {
         -webkit-tap-highlight-color: transparent;
     }

     .lesson-card:active,
     .special-card:active,
     .option-btn:active {
         transform: scale(0.98);
     }
 }

 /* Safe area for notched phones */
 @supports (padding-top: env(safe-area-inset-top)) {
     header {
         padding-top: calc(0.75rem + env(safe-area-inset-top));
     }

     .modal-header {
         padding-top: calc(0.6rem + env(safe-area-inset-top));
     }
 }

/* Mobile Toggle Button - 3D Keycap Style */
.mobile-toggle-btn,
#mobileToggle {
    background: linear-gradient(145deg, #1e1e2f, #151525) !important;
    border: none !important;
    border-radius: 12px !important;
    width: 44px !important;
    height: 44px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    color: rgba(255, 255, 255, 0.7) !important;
    padding: 0 !important;
    font-size: 20px !important;
    
    /* 3D Effect - Raised State */
    box-shadow: 
        5px 5px 10px rgba(0, 0, 0, 0.5),
        -2px -2px 6px rgba(255, 255, 255, 0.05),
        inset 0 0 0 1px rgba(255, 255, 255, 0.05) !important;
        
    transition: all 0.15s ease !important;
    position: relative !important;
    margin-left: 0.5rem !important;
}

.mobile-toggle-btn:hover,
#mobileToggle:hover {
    color: #fff !important;
    transform: translateY(-1px) !important;
    box-shadow: 
        6px 6px 12px rgba(0, 0, 0, 0.6),
        -2px -2px 8px rgba(255, 255, 255, 0.08) !important;
}

.mobile-toggle-btn.active,
#mobileToggle.active {
    background: linear-gradient(145deg, #151525, #1e1e2f) !important;
    color: #4ade80 !important;
    
    /* 3D Effect - Pressed State */
    box-shadow: 
        inset 5px 5px 10px rgba(0, 0, 0, 0.6),
        inset -2px -2px 6px rgba(255, 255, 255, 0.05) !important;
        
    transform: translateY(2px) !important;
}

.mobile-toggle-btn svg,
#mobileToggle svg {
    width: 24px !important;
    height: 24px !important;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.3s ease;
}

.mobile-toggle-btn.active svg,
#mobileToggle.active svg {
    filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));
    transform: scale(0.95);
}
